---
title: "Homophily-Functions"
author: "Emily Coco"
date: "7/8/2019"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

HHI function
```{r}
get.hhi <- function(nodes, edges, column) {
  for(i in unique(nodes$id)) {
    cur.edges <- edges[edges$from == i,]
    cur.edges <- cur.edges[-1]
    colnames(cur.edges) <- c("from", "id", "rel","color", "dir")
    cur.edges <- left_join(cur.edges, nodes, by = "id")
    
    if(!is.null(dim(cur.edges))) {
      shares <- as.data.frame(table(cur.edges[,column]))[as.data.frame(table(cur.edges[,column]))$Freq != 0, ]
      shares$prop <- shares$Freq/sum(shares$Freq)
      return(hhi(shares, "prop"))
    }
  }
}
```

